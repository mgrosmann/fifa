--nombre de nom non utiliser
SELECT COUNT(*) AS nb_a_supprimer
FROM playernames pn
LEFT JOIN players p1 ON p1.firstnameid = pn.nameid
LEFT JOIN players p2 ON p2.lastnameid = pn.nameid
LEFT JOIN players p3 ON p3.commonnameid = pn.nameid
LEFT JOIN players p4 ON p4.playerjerseynameid = pn.nameid
WHERE p1.firstnameid IS NULL
  AND p2.lastnameid IS NULL
  AND p3.commonnameid IS NULL
  AND p4.playerjerseynameid IS NULL;
--les noms inactif
SELECT pn.nameid, pn.name
FROM playernames pn
LEFT JOIN players p1 ON p1.firstnameid = pn.nameid
LEFT JOIN players p2 ON p2.lastnameid = pn.nameid
LEFT JOIN players p3 ON p3.commonnameid = pn.nameid
LEFT JOIN players p4 ON p4.playerjerseynameid = pn.nameid
WHERE p1.firstnameid IS NULL
  AND p2.lastnameid IS NULL
  AND p3.commonnameid IS NULL
  AND p4.playerjerseynameid IS NULL;
--place libre
SELECT 29000 - COUNT(*) AS nb_libres
FROM playernames;
--supprimer
DELETE FROM playernames
WHERE nameid IN (
    SELECT nameid
    FROM (
        SELECT pn.nameid
        FROM playernames pn
        LEFT JOIN players p1 ON p1.firstnameid = pn.nameid
        LEFT JOIN players p2 ON p2.lastnameid = pn.nameid
        LEFT JOIN players p3 ON p3.commonnameid = pn.nameid
        LEFT JOIN players p4 ON p4.playerjerseynameid = pn.nameid
        WHERE p1.firstnameid IS NULL
          AND p2.lastnameid IS NULL
          AND p3.commonnameid IS NULL
          AND p4.playerjerseynameid IS NULL
    ) AS t
);
