mysqldump -uroot -proot -h127.0.0.1 -P5000 FC15 > save0.sql
pour 1686

playernames 8 minutes
players 16:37 20 sec -> 16 43 fin suppression -> 16:58 (total 21 minutes)
tpl 16:58 ->
--version avec teams
SELECT p.commonnameid, p.playerid, p.overallrating, tpl.teamid, t.teamname, CONCAT(pn_first.name, ' ', pn_last.name) as fullname, pn_first.nameid, pn_last.nameid FROM players p JOIN playernames pn_first ON p.firstnameid = pn_first.nameid JOIN playernames pn_last  ON p.lastnameid  = pn_last.nameid JOIN teamplayerlinks tpl on p.playerid = tpl.playerid JOIN teams t on tpl.teamid = t.teamid WHERE CONCAT(pn_first.name, ' ', pn_last.name) like '%zidane%';

--version sans teams
SELECT p.commonnameid, p.playerid, p.overallrating, CONCAT(pn_first.name, ' ', pn_last.name) as fullname, pn_first.nameid, pn_last.nameid FROM players p JOIN playernames pn_first ON p.firstnameid = pn_first.nameid JOIN playernames pn_last  ON p.lastnameid  = pn_last.nameid WHERE CONCAT(pn_first.name, ' ', pn_last.name) like '%zidane%';


--lister joueur teams
SELECT tpl.artificialkey as akey, tpl.jerseynumber as jnb,p.playerid, tpl.position, p.overallrating as gen, p.potential as pot, t.teamname, CONCAT(pn_first.name, ' ', pn_last.name) as fullname, pn_first.nameid as fid, pn_last.nameid as lid, pn_common.nameid as cid FROM teamplayerlinks tpl JOIN teams t ON tpl.teamid = t.teamid join players p on tpl.playerid = p.playerid JOIN playernames pn_common on p.commonnameid = pn_common.nameid JOIN playernames pn_first ON p.firstnameid = pn_first.nameid JOIN playernames pn_last  ON p.lastnameid  = pn_last.nameid WHERE t.teamname LIKE '%real madrid%' order by tpl.artificialkey;

SET @k := -1;

UPDATE teamplayerlinks t
JOIN (
    SELECT playerid, teamid, position,
           (@k := @k + 1) AS new_key
    FROM teamplayerlinks
    ORDER BY teamid, position, playerid
) x
ON t.playerid = x.playerid AND t.teamid = x.teamid AND t.position = x.position
SET t.artificialkey = x.new_key;

UPDATE playernames SET name = 'Gabriel', commentaryid = '9000000', nameid = 7928 WHERE commentaryid = '� el';
UPDATE playernames SET name = 'Niraj', commentaryid = '9000000', nameid = 9892 WHERE commentaryid = '� aj';
UPDATE playernames SET name = 'Kuba',  commentaryid = '9000000', nameid = 14555 WHERE commentaryid = '� ';
ALTER TABLE playernames MODIFY COLUMN commentaryid INT UNSIGNED;

UPDATE playernames SET name = 'Niraj', commentaryid = '9000000', nameid = 16443 WHERE commentaryid = '� aj';
UPDATE playernames SET name = 'staro',  commentaryid = '9000000', nameid = 21224 WHERE commentaryid = '� o';
ALTER TABLE playernames MODIFY COLUMN commentaryid INT UNSIGNED;



CREATE TABLE tmp_loan (
    teamidloanedfrom  INT,
    playerid INT ,
    loandateend INT
);
LOAD DATA LOCAL INFILE '/mnt/c/github/txt/FIFA16/csv/playerloans.csv'
INTO TABLE tmp_loan
FIELDS TERMINATED BY ';'
LINES TERMINATED BY '\n'
IGNORE 1 ROWS;


DELETE tl
FROM tmp_loan tl
LEFT JOIN FC16.players p
    ON tl.playerid = p.playerid
WHERE p.playerid IS NULL;


start=$(date +%s)

end=$(date +%s)
elapsed=$(( end - start ))
printf "Durée : %02d:%02d:%02d\n" \
    $((elapsed/3600)) $(((elapsed%3600)/60)) $((elapsed%60))

Durée : 00:19:46 946 log.txt
Durée : 00:00:06 16 1log.txt
